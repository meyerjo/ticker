{% extends 'base.html' %}

{% block extracss %}
    <style>
        .teamname {
            font-size: 2em;
            text-align:center;
            display:block;
        }

        .score {
            font-size: 2em;
            font-weight: bold;
            text-align: center;
        }

        .lineupsave {
            width: 100%;
        }
    </style>
{% endblock %}

{% block extrajs %}
    {#    <script type="text/javascript">#}
    {#        $(document).ready(function () {#}
    {#            $('button.lineup').on('click', function () {#}
    {#                event.preventDefault();#}
    {#                var data = $('form').serializeArray();#}
    {#                console.log('Test')#}
    {#                console.log(data);#}
    {#                $.ajax({#}
    {#                    url: '{% url 'match_lineup_save' match.id %}',#}
    {#                    method: 'get',#}
    {#                    data: {'data':data}#}
    {#                }).done(function(data) {#}
    {#                            console.log(data)#}
    {#                        }#}
    {#                )#}
    {#            })#}
    {#        })#}
    {#    </script>#}
{% endblock %}


{% block content %}
    <div class="container">
        {% if messages %}
            <div class="row-fluid">
                <div class="col-sm-12">
                    <ul class="messages">
                        {% for message in messages %}
                            <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>
                                {{ message }}
                            </li>
                        {% endfor %}
                    </ul>
                </div>
            </div>
        {% endif %}
        <div class="row-fluid headline">
            {% with score=match.get_score team_names=match.get_team_names %}
                <div class="col-sm-4 teamname">{{ team_names.0 }} <a href="{% url 'manage_teams_details' match.team_a.id %}">(<i class="fa fa-link"></i>)</a></div>
                <div class="col-sm-4 score">{{ score.0 }} - {{ score.1 }}</div>
                <div class="col-sm-4 teamname">{{ team_names.1 }} <a href="{% url 'manage_teams_details' match.team_b.id %}">(<i class="fa fa-link"></i>)</a></div>
            {% endwith %}
        </div>
        <div class="row-fluid fields">

        </div>
        <div class="row-fluid matches">
            <div class="col-sm-12">
                <form method="post" action="{% url 'match_lineup_save' match.id '/' %}">
                    {% csrf_token %}
                    <table class="table table-responsive table-striped">
                        <tr>
                            <th>ID</th>
                            <th>Gamename</th>
                            <th>Spieler (Heim)</th>
                            <th>Spieler (Gast)</th>
                            <th>Saetze</th>
                            <th>Feld</th>
                            <th>Editieren</th>
                        </tr>
                        {% for game in match.get_all_games %}
                            <tr>
                                <td>{{ game.id }} <input type="hidden" name="game_id" value="{{ game.id }}"/> </td>
                                <td>{{ game.name }}</td>
                                <td>
                                    {% load custom_tags %}
                                    <select name="player_a_one_{{ game.id }}">
                                        {% for player in game|get_players:"1,a" %}
                                            <option value="{{ player.0 }}" {{ player.2|is_selected }}>{{ player.1 }}</option>
                                        {% endfor %}
                                    </select>
                                    {% if game.game_type|is_in:"single" == 0 %}
                                        <select name="player_a_two_{{ game.id }}">
                                            {% for player in game|get_players:"2,a" %}
                                                <option value="{{ player.0 }}" {{ player.2|is_selected }}>{{ player.1 }}</option>
                                            {% endfor %}
                                        </select>
                                    {% endif %}
                                </td>
                                <td>
                                    {% load custom_tags %}
                                    <select name="player_b_one_{{ game.id }}">
                                        {% for player in game|get_players:"1,b" %}
                                            <option value="{{ player.0 }}" {{ player.2|is_selected }}>{{ player.1 }}</option>
                                        {% endfor %}
                                    </select>
                                    {% if game.game_type|is_in:"single" == 0 %}
                                        <select name="player_b_two_{{ game.id }}">
                                            {% for player in game|get_players:"2,b" %}
                                            <option value="{{ player.0 }}" {{ player.2|is_selected }}>{{ player.1 }}</option>
                                            {% endfor %}
                                        </select>
                                    {% endif %}
                                </td>
                                <td>{{ game.get_sets }}</td>
                                <td>
                                    {% for field in game.get_fields %}
                                        <a href="#TODO" class="fieldname">{{ field.shortform }}</a>
                                    {% endfor %}
                                </td>
                                <td>
                                    <a href="#EDIT">Edit</a>
                                </td>
                            </tr>
                        {% endfor %}
                        <tr>
                            <td colspan="2"></td>
                            <td colspan="2">
                                <button class="btn btn-success lineup" value="lineup">Speichern</button>
                            </td>
                            <td colspan="2"></td>
                        </tr>
                    </table>
                </form>
            </div>
        </div>
    </div>
{% endblock %}